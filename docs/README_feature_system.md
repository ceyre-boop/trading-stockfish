# Feature System Overview

Deterministic, audited feature pipeline: registry → extractor → audit → drift → stats → policy → evaluator → runner.

## Artifacts
- Feature spec (registry): see `docs/feature_spec_schema.md` and `schemas/feature_spec.schema.json` (v1.0.0)
- Feature audits: see `docs/feature_audit_schema.md` and `schemas/feature_audit.schema.json` (v1.0.0)
- Drift reports: generated by `analytics/feature_drift_detector.py`
- Stats: `logs/feature_stats.json` (consumed by policy builder)
- Policy: `logs/policy_config.json` (v0.3.0) consumed by evaluator

## Flow
1) **Registry**: defines features, aliases, constraints, transforms.
2) **Extractor/Audit**: builds feature values and emits audits (issues, summary, snapshot).
3) **Drift detector**: consumes audits to flag spikes, new categories, persistent missingness.
4) **Stats harness**: aggregates stats (missing frac, variance, distributions).
5) **Policy builder**: consumes registry/stats/drift → writes policy_config (base_weights, trust, regime_multipliers).
6) **Evaluator**: applies policy (base × trust × regime multipliers) to causal factors with provenance.
7) **Runner**: passes policy into evaluations/tournaments; outputs are deterministic and auditable.

## Testing guidance
- Validate registry and audits against JSON Schemas in `schemas/`.
- Drift detector tests cover spikes, missingness, new categories, ordering.
- Add round-trip tests: registry → audit → drift → stats → policy → evaluator.
